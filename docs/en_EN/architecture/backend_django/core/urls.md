# üìú Root URL Configuration (`urls.py`)

[‚¨ÖÔ∏è Back](./README.md) | [üè† Docs Root](../../../README.md)

This `urls.py` file defines the root URL configuration for the entire Django backend project. It aggregates URL patterns from various applications and features, handles internationalization (i18n), and sets up special routes for API, static files, sitemaps, and debugging tools.

## Purpose

The root `urls.py` acts as the central dispatcher for all incoming HTTP requests, routing them to the appropriate views or sub-URL configurations based on the URL pattern.

## Sections

### Non-i18n Patterns (`urlpatterns`)

This list contains URL patterns that are not subject to internationalization (i.e., they do not have a language prefix). These typically include technical endpoints, APIs, and static content.

```python
urlpatterns = [
    path("i18n/", include("django.conf.urls.i18n")),  # For set_language view
    path("api/", api.urls),
    path("", include("django_prometheus.urls")),  # Prometheus metrics
    path("robots.txt", TemplateView.as_view(template_name="robots.txt", content_type="text/plain")),
    path("sitemap.xml", sitemap, {"sitemaps": sitemaps}, name="django.contrib.sitemaps.views.sitemap"),
]
```

*   `path("i18n/", include("django.conf.urls.i18n"))`: Includes Django's built-in i18n URLs, primarily for the `set_language` view.
*   `path("api/", api.urls)`: Includes the URL patterns defined in `api.urls` (from `src/backend_django/api/urls.py`), which typically handles REST API endpoints.
*   `path("", include("django_prometheus.urls"))`: Includes URL patterns for Prometheus metrics, provided by `django-prometheus`.
*   `path("robots.txt", ...)`: Serves a `robots.txt` file using a `TemplateView`.
*   `path("sitemap.xml", ...)`: Serves the `sitemap.xml` file, generated by Django's sitemap framework using the `sitemaps` dictionary from `core.sitemaps`.

### i18n Patterns (`urlpatterns += i18n_patterns(...)`)

This section defines URL patterns that are internationalized, meaning they will have a language prefix (e.g., `/en/admin/`, `/de/admin/`).

```python
urlpatterns += i18n_patterns(
    path("admin/", admin.site.urls),
    path("llms.txt", LLMSTextView.as_view()),
    path("", include("features.booking.urls")),
    path("", include("features.main.urls")),
)
```

*   `path("admin/", admin.site.urls)`: Includes Django's administration site URLs.
*   `path("llms.txt", LLMSTextView.as_view())`: Serves a `llms.txt` file (similar to `robots.txt` but for Large Language Models/AI crawlers) using a custom view.
*   `path("", include("features.booking.urls"))`: Includes URL patterns from the `booking` feature.
*   `path("", include("features.main.urls"))`: Includes URL patterns from the `main` feature.

### Debug-only Patterns

```python
if settings.DEBUG:
    from debug_toolbar.toolbar import debug_toolbar_urls

    urlpatterns += debug_toolbar_urls()
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```
This block is conditionally included only when `settings.DEBUG` is `True`.
*   `debug_toolbar_urls()`: Includes URL patterns for the Django Debug Toolbar.
*   `static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)`: Configures Django to serve media files directly during development. This is not used in production, where Nginx typically handles media serving.

### Custom Error Handlers

```python
handler400 = "django.views.defaults.bad_request"
handler403 = "django.views.defaults.permission_denied"
handler404 = "django.views.defaults.page_not_found"
handler500 = "django.views.defaults.server_error"
```
These variables define custom views to be used for specific HTTP error codes (400, 403, 404, 500). These handlers are active only when `DEBUG = False`.
